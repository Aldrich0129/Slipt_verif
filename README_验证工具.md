# PDF工资单验证工具

## 功能说明

此工具用于验证拆分后的PDF工资单文件名与内容是否匹配，确保文件命名的准确性。

### 主要功能

1. **批量验证PDF文件**
   - 自动读取文件夹中的所有PDF文件
   - 提取文件名中的编号、姓名、日期信息
   - 从PDF内容中提取编号、姓名等关键信息

2. **智能比对**
   - 验证文件名中的编号与PDF中的编号是否一致
   - 验证文件名中的姓名与PDF中的姓名是否一致
   - 智能容错：自动标准化姓名格式（去重音、大小写、空格等）

3. **Excel报告生成**
   - 生成带颜色标记的详细Excel报告
   - 绿色 = 匹配 ✓
   - 红色 = 不匹配 ✗
   - 黄色 = 错误说明
   - 包含统计信息（总数、匹配数、匹配率）

### 文件名格式

工具支持以下文件名格式：
```
编号_姓名_Payslip_日期.pdf
```

示例：
```
809_MARTINEZ MONTERO_ LAURA MARIA_Payslip_01092024.pdf
```

## 安装说明

### 方法1：直接运行Python脚本

#### 前置要求
- Python 3.7 或更高版本
- pip包管理器

#### 安装步骤

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python pdf_validator.py
```

### 方法2：打包成可执行文件（.exe）

#### Windows系统

1. 运行打包脚本：
```bash
build_exe.bat
```

2. 打包完成后，可执行文件位于：
```
dist/PDF验证工具.exe
```

3. 双击运行即可使用

#### Linux/Mac系统

1. 添加执行权限：
```bash
chmod +x build_exe.sh
```

2. 运行打包脚本：
```bash
./build_exe.sh
```

3. 打包完成后，可执行文件位于：
```
dist/PDF验证工具
```

## 使用说明

### 步骤1：启动程序
- 双击运行可执行文件，或使用命令行运行Python脚本

### 步骤2：选择文件夹
- 点击"选择PDF文件夹"按钮
- 浏览并选择包含待验证PDF文件的文件夹

### 步骤3：等待验证
- 程序会自动验证所有PDF文件
- 进度条显示当前进度

### 步骤4：查看报告
- 验证完成后，会在同一文件夹生成Excel报告
- 报告文件名格式：`验证报告_YYYYMMDD_HHMMSS.xlsx`
- 程序会询问是否立即打开报告

## Excel报告说明

### 列说明

| 列名 | 说明 |
|-----|------|
| 文件名 | PDF文件的完整文件名 |
| 文件名-编号 | 从文件名中提取的编号 |
| 文件名-姓名 | 从文件名中提取的姓名 |
| 文件名-日期 | 从文件名中提取的日期 |
| PDF-编号 | 从PDF内容中提取的编号 |
| PDF-姓名 | 从PDF内容中提取的姓名 |
| PDF-NIF | 从PDF中提取的身份证号 |
| PDF-期间 | 从PDF中提取的工资期间 |
| PDF-社保号 | 从PDF中提取的社保号 |
| 编号匹配 | 编号是否匹配（✓/✗） |
| 姓名匹配 | 姓名是否匹配（✓/✗） |
| 验证结果 | 总体验证结果（匹配/不匹配） |
| 错误说明 | 不匹配时的详细说明 |

### 颜色标记

- **绿色背景**：该项验证通过
- **红色背景**：该项验证失败
- **黄色背景**：有错误说明

### 统计信息

报告底部包含以下统计信息：
- 总文件数
- 匹配数量
- 不匹配数量
- 匹配率

## 技术说明

### 提取的信息

从PDF中提取以下信息：
1. **编号**：格式如 `809/1` 中的 `809`
2. **姓名**：完整姓名，如 `MARTINEZ MONTERO, LAURA MARIA`
3. **NIF**：身份证号
4. **期间**：工资期间
5. **社保号**：Nº. Afiliación S.S.

### 验证规则

1. **编号验证**：文件名编号必须与PDF中的编号完全一致
2. **姓名验证**：
   - 自动标准化处理（去重音、统一大小写）
   - 支持格式差异（逗号、下划线、空格）
   - 相似度 ≥ 80% 即判定为匹配

## 常见问题

### Q: 为什么有些文件显示"不匹配"？
A: 可能的原因：
- 文件名格式不符合规范
- PDF内容无法正确识别
- 编号或姓名确实不一致

### Q: 如何处理不匹配的文件？
A:
1. 查看Excel报告中的"错误说明"列
2. 根据说明修改文件名或检查PDF内容
3. 重新运行验证

### Q: 程序无法识别某些PDF怎么办？
A:
- 确保PDF文件未损坏
- 检查PDF格式是否正确
- 查看PDF内容是否清晰可读

## 依赖库

- **PyMuPDF (fitz)**: PDF文件读取和处理
- **openpyxl**: Excel文件生成和格式化
- **tkinter**: 图形用户界面（Python标准库）

## 版本历史

### v1.0.0 (2024)
- 初始版本
- 基本验证功能
- Excel报告生成
- GUI界面

## 联系方式

如有问题或建议，请联系开发团队。

---

**注意**: 此工具仅用于验证文件名与内容的一致性，不会修改任何文件。
