# PDF工资单验证工具 - 快速开始指南

## 概述

此工具用于验证拆分后的PDF工资单文件名与内容是否匹配，防止文件命名错误。

## 功能特点

- ✅ 批量验证PDF文件
- ✅ 自动提取并比对编号和姓名
- ✅ 生成带颜色标记的Excel报告
- ✅ 支持命令行和GUI两种模式
- ✅ 可打包成独立exe文件

## 快速使用

### 方式1：直接运行Python脚本

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 运行GUI版本（需要图形界面环境）
python pdf_validator.py

# 或运行命令行版本
python -c "from validator_core import validate_folder, generate_excel_report; \
results = validate_folder('/path/to/pdf/folder'); \
generate_excel_report(results, 'report.xlsx')"
```

### 方式2：运行测试（推荐先运行测试验证）

```bash
# 执行自动测试套件
python test_validator.py
```

测试会验证以下功能：
1. 文件名解析
2. PDF信息提取
3. 比对逻辑
4. 完整流程集成测试

### 方式3：打包成可执行文件

#### Windows系统
```bash
# 运行打包脚本
build_exe.bat

# 生成的exe位于：dist/PDF验证工具.exe
```

#### Linux/Mac系统
```bash
# 添加执行权限
chmod +x build_exe.sh

# 运行打包脚本
./build_exe.sh

# 生成的文件位于：dist/PDF验证工具
```

## 文件结构

```
Slipt_verif/
├── validator_core.py           # 核心验证逻辑（无GUI依赖）
├── pdf_validator.py            # GUI应用程序
├── test_validator.py           # 自动测试脚本
├── requirements.txt            # Python依赖
├── build_exe.sh               # Linux/Mac打包脚本
├── build_exe.bat              # Windows打包脚本
├── README_验证工具.md          # 详细文档
├── 快速开始.md                 # 本文件
└── split_nominas_personio.py  # 原PDF拆分脚本
```

## 支持的文件名格式

```
编号_姓名_Payslip_日期.pdf
```

示例：
```
809_MARTINEZ MONTERO_ LAURA MARIA_Payslip_01092024.pdf
810_GARCIA_LOPEZ_JUAN_Payslip_01_10_2024.pdf
```

## 验证内容

工具会验证以下内容：

1. **编号匹配**
   - 文件名中的编号（如 `809`）
   - PDF中的编号（格式：`809/1`）

2. **姓名匹配**
   - 文件名中的姓名（如 `MARTINEZ MONTERO LAURA MARIA`）
   - PDF中的姓名（格式：`MARTINEZ MONTERO, LAURA MARIA`）
   - 智能容错：自动处理格式差异、重音符号、大小写等

## Excel报告说明

生成的报告包含以下信息：

### 数据列
- 文件名、编号、姓名、日期
- PDF内容：编号、姓名、NIF、期间、社保号
- 匹配结果：编号匹配、姓名匹配、总体验证结果
- 错误说明

### 颜色标记
- 🟢 绿色 = 匹配
- 🔴 红色 = 不匹配
- 🟡 黄色 = 错误说明

### 统计信息
- 总文件数
- 匹配/不匹配数量
- 匹配率

## 测试结果

已完成3次自动测试验证：

```
测试1: ✓ 文件名解析 (3/3 通过)
测试2: ✓ PDF信息提取 (5/5 通过)
测试3: ✓ 比对逻辑 (6/6 通过)
测试4: ✓ 集成测试 (3/3 通过)

总计: 4/4 测试通过 ✓✓✓
```

## 常见问题

### Q: 运行时提示缺少模块？
A: 运行 `pip install -r requirements.txt` 安装依赖

### Q: 无法打开GUI？
A: 使用 `validator_core.py` 模块，它不需要GUI

### Q: 如何处理不匹配的文件？
A: 查看Excel报告中的"错误说明"列，根据提示修正文件名或检查PDF内容

### Q: 支持哪些PDF格式？
A: 支持标准PDF格式，要求PDF中包含可提取的文本内容

## 技术支持

遇到问题请查看：
- 详细文档：`README_验证工具.md`
- 测试脚本：`test_validator.py`

---

**版本**: 1.0.0
**最后更新**: 2024
**测试状态**: ✅ 全部通过
